# [2ì£¼ì°¨] ê¸°ë³¸ê³¼ì œ: ì£¼ì–´ì§„ ë¬¸ì¥ì—ì„œ ë‚˜ì˜¬ ë‹¤ìŒ ë‹¨ì–´ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ êµ¬í˜„

<aside>
ğŸ’¡ **ì´ë²ˆ ê³¼ì œì—ì„œëŠ” Transformerë¥¼ last word predictionì´ë¼ëŠ” taskì— ì ìš©í•©ë‹ˆë‹¤. Last word predictionì€ Token listê°€ ì£¼ì–´ì¡Œì„ ë•Œ, ë‹¤ìŒìœ¼ë¡œ ì˜¤ëŠ” tokenì„ ì˜ˆì¸¡í•˜ëŠ” taskë¡œ, ì¶”í›„ ë“±ì¥í•  LLMì˜ í•µì‹¬ì…ë‹ˆë‹¤.**

</aside>

## ì¤€ë¹„

---

Transformer ì‹¤ìŠµì„ ì§„í–‰í•œ notebook ìœ„ì—ì„œ ì§„í–‰í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤:

[](https://drive.google.com/file/d/1vh4ALpRVicq9hdonHYiLTlsPhY6LLZAE/view?usp=share_link)

## ëª©í‘œ

---

- [ ]  Last word prediction dataset ì¤€ë¹„
    - ê¸°ì¡´ì˜ IMDB datasetì„ ê·¸ëŒ€ë¡œ í™œìš©í•˜ê³ , `collate_fn`ì„ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜ì •í•˜ë©´ ë©ë‹ˆë‹¤:
        
        ```python
        from torch.nn.utils.rnn import pad_sequence
        
        def collate_fn(batch):
          max_len = 400
          texts, labels = [], []
          for row in batch:
            labels.append(tokenizer(row['text'], truncation=True, max_length=max_len).input_ids[-2])
            texts.append(torch.LongTensor(tokenizer(row['text'], truncation=True, max_length=max_len).input_ids[:-2]))
        
          texts = pad_sequence(texts, batch_first=True, padding_value=tokenizer.pad_token_id)
          labels = torch.LongTensor(labels)
        
          return texts, labels
        ```
        
- [ ]  Loss function ë° classifier output ë³€ê²½
    - ë§ˆì§€ë§‰ token idë¥¼ ì˜ˆì¸¡í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— binary classificationì´ ì•„ë‹Œ ì¼ë°˜ì ì¸ classification ë¬¸ì œë¡œ ë°”ë€ë‹ˆë‹¤. MNIST ê³¼ì œì—ì„œ í–ˆë˜ ê²ƒ ì²˜ëŸ¼ lossì™€ `TextClassifier`ì˜ ì¶œë ¥ ì°¨ì›ì„ ì˜ ì¡°ì •í•˜ì—¬ taskë¥¼ í’€ ìˆ˜ ìˆë„ë¡ ìˆ˜ì •í•˜ì‹œë©´ ë©ë‹ˆë‹¤.
- [ ]  í•™ìŠµ ê²°ê³¼ report
    - ê¸°ì¡´ Transformer ì‹¤ìŠµì—ì„œ ì‚¬ìš©í•œ ëª¨ë¸ë¡œ last word predictionì„ í•™ìŠµí•˜ê³  í•™ìŠµ ê²½ê³¼ë¥¼ reportí•˜ë©´ ë©ë‹ˆë‹¤.

## ì œì¶œìë£Œ

---

ì œì•½ ì¡°ê±´ì€ ì „í˜€ ì—†ìœ¼ë©°, ìœ„ì˜ ì‚¬í•­ë“¤ì„ êµ¬í˜„í•˜ê³  epochë§ˆë‹¤ì˜ train accuracyì™€ test accuracyê°€ printëœ notebookì„ public github repositoryì— ì—…ë¡œë“œí•˜ì—¬ ê³µìœ í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤(**ë°˜ë“œì‹œ ì¶œë ¥ ê²°ê³¼ê°€ ë‚¨ì•„ìˆì–´ì•¼ í•©ë‹ˆë‹¤!!**).
