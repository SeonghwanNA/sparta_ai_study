# [1ì£¼ì°¨] ê¸°ë³¸ê³¼ì œ: MNISTë¥¼ ë¶„ë¥˜ ëª¨ë¸ë¡œ í•™ìŠµí•˜ê¸°

### MNIST ë¶„ë¥˜(classification) ëª¨ë¸ êµ¬í˜„

<aside>
ğŸ’¡ ì´ë²ˆ ê³¼ì œì—ì„œëŠ” MNISTë¥¼ regression modelì´ ì•„ë‹Œ classification modelë¡œ êµ¬í˜„í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  trainê³¼ test dataì— ëŒ€í•œ ëª¨ë¸ì˜ ì •í™•ë„ë¥¼ plotí•˜ì—¬ generalization errorë¥¼ ì‚´í´ë´…ë‹ˆë‹¤.

</aside>

## ì¤€ë¹„

---

MNIST ì‹¤ìŠµì„ ì§„í–‰í•œ notebook ìœ„ì—ì„œ ê³¼ì œë¥¼ ìˆ˜í–‰í•˜ì‹œë©´ ë©ë‹ˆë‹¤:

[](https://drive.google.com/file/d/1t5mCDlTDGIDe30cuh2GpiUOalakPz_hF/view?usp=drive_link)

## ëª©í‘œ

---

MNIST ì‹¤ìŠµê³¼ ë˜‘ê°™ì€ taskì™€ modelì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ëŒ€ì‹  ë‹¤ìŒì˜ ëª©í‘œë“¤ì„ notebookì—ì„œ ë§ˆì € êµ¬í˜„í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤:

- [ ]  Test data ì¤€ë¹„í•˜ê¸°
    - Test dataëŠ” MNISTì˜ train dataë¥¼ loadí•˜ëŠ” ì½”ë“œì—ì„œ `train=False`ë¡œ ë‘ë©´ ë©ë‹ˆë‹¤.
    - Train dataì™€ ë§ˆì°¬ê°€ì§€ë¡œ test dataì— ëŒ€í•œ data loaderë¥¼ ìƒì„±í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤(batch sizeëŠ” ë™ì¼í•˜ê²Œ ì ìš©).
        - Test dataëŠ” ëœë¤í•˜ê²Œ ì„ì¼ í•„ìš”ê°€ ì—†ê¸° ë•Œë¬¸ì— `shuffle=False`ë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
- [ ]  `nn.CrossEntropyLoss` ì ìš©í•˜ê¸°
    - í˜„ì¬ ì½”ë“œëŠ” regression modelì„ êµ¬í˜„í•œ ìƒíƒœë¡œ, MSEë¥¼ lossë¡œ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤.
    - í•˜ì§€ë§Œ MNISTì™€ ê°™ì€ ë¶„ë¥˜ ë¬¸ì œì—ì„œëŠ” MSEëŠ” ì í•©í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
        - MSEì— ë”°ë¥´ë©´ 1ì— í•´ë‹¹í•˜ëŠ” ì†ê¸€ì”¨ ì´ë¯¸ì§€ëŠ” 7ì— í•´ë‹¹í•˜ëŠ” ì†ê¸€ì”¨ ì´ë¯¸ì§€ë³´ë‹¤ 0ì— í•´ë‹¹í•˜ëŠ” ì†ê¸€ì”¨ ì´ë¯¸ì§€ê°€ ë” ê°€ê¹ê²Œ ì—¬ê²¨ì§‘ë‹ˆë‹¤.
        - í•˜ì§€ë§Œ 1ì€ ì‹¤ì œë¡œ 0ë³´ë‹¤ 7ê³¼ ë” ë¹„ìŠ·í•˜ê²Œ ìƒê²¼ìŠµë‹ˆë‹¤.
    - ì¼ë°˜ì ìœ¼ë¡œ ë¶„ë¥˜ ë¬¸ì œëŠ” MSE ëŒ€ì‹  cross entropy lossë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
    - PyTorchì—ì„œì˜ [cross entropy loss ë¬¸ì„œ](https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html) ë˜ëŠ” [ì›¹ ìë£Œ](https://uumini.tistory.com/54)ë“¤ì„ í†µí•´ ì´í•´í•œ í›„, MSEë¥¼ ëŒ€ì²´í•˜ëŠ” ì½”ë“œë¥¼ êµ¬í˜„í•˜ì‹œë©´ ë©ë‹ˆë‹¤.
        - ë³€ê²½ë˜ì–´ì•¼ í•  ì ì€ 2ê°€ì§€ë¡œ i) `Model`ì˜ ìµœì¢… outputì˜ dimensionê³¼ ii) `loss` ê³„ì‚° ë¶€ë¶„ì…ë‹ˆë‹¤.
- [ ]  í•™ìŠµì„ ì§„í–‰í•œ í›„, epochì— ë”°ë¥¸ modelì˜ trainê³¼ test dataì— ëŒ€í•œ ì •í™•ë„ plotí•˜ê¸°
    - ë‹¤ìŒ ì¡°ê±´ë“¤ ì•„ë˜ì—ì„œ í•™ìŠµì„ ì§„í–‰í•˜ë©´ ë©ë‹ˆë‹¤.
        - `n_epochs`=100, `batch_size`=256, `lr`=0.001.
    - ì–´ë–¤ dataloaderì— ëŒ€í•œ modelì˜ ì •í™•ë„ë¥¼ ì¸¡ì •í•˜ëŠ” ì½”ë“œëŠ” ë‹¤ìŒ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì‹œë©´ ë©ë‹ˆë‹¤:
        
        ```python
        def accuracy(model, dataloader):
          cnt = 0
          acc = 0
        
          for data in dataloader:
            inputs, labels = data
            inputs, labels = inputs.to('cuda'), labels.to('cuda')
        
            preds = model(inputs)
            preds = torch.argmax(preds, dim=-1)
        
            cnt += labels.shape[0]
            acc += (labels == preds).sum().item()
        
          return acc / cnt
        ```
        
    - ì¶”ê°€ì ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ì•¼ í•˜ëŠ” ë¶€ë¶„ë“¤ì„ ìš”ì•½í•˜ë©´ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:
        - ë§¤ epochê°€ ëë‚œ ë’¤ì˜ modelì˜ `trainloader`ì™€ `testloader`ì— ëŒ€í•œ ì •í™•ë„ë¥¼ ê°ê° listë¡œ ì €ì¥í•´ë‘¡ë‹ˆë‹¤.
        - Epochì— ë”°ë¥¸ trainê³¼ test dataì— ëŒ€í•œ modelì˜ ì •í™•ë„ë¥¼ ë‹¤ìŒ ì½”ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ plotí•©ë‹ˆë‹¤:
            
            ```python
            def plot_acc(train_accs, test_accs, label1='train', label2='test'):
              x = np.arange(len(train_accs))
            
              plt.plot(x, train_accs, label=label1)
              plt.plot(x, test_accs, label=label2)
              plt.legend()
              plt.show()
            ```
            

## ì œì¶œìë£Œ

---

ì œì•½ ì¡°ê±´ì€ ì „í˜€ ì—†ìœ¼ë©°, ìœ„ì˜ ì‚¬í•­ë“¤ì„ êµ¬í˜„í•˜ê³  plotì´ 1ê°œ í¬í•¨ëœ notebookì„ public github repositoryì— ì—…ë¡œë“œí•˜ì—¬ ê³µìœ í•´ì£¼ì‹œë©´ ë©ë‹ˆë‹¤(**ë°˜ë“œì‹œ ì¶œë ¥ ê²°ê³¼ê°€ ë‚¨ì•„ìˆì–´ì•¼ í•©ë‹ˆë‹¤!!**).
